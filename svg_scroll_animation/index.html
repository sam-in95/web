<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SVG scroll test</title>

    <style>
      * {
        margin: 0;
        padding: 0;
      }

      .svg_content {
        margin-top: 910px;
        margin-left: 345px;
      }

      .path_332 {
        stroke: orange;
        stroke-width: 2px;
      }
    </style>
  </head>
  <body>
    <div class="svg_content">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1514.112"
        height="4921.973"
        viewBox="0 0 1514.112 4921.973"
      >
        <path
          class="path_332"
          data-name="path 332"
          d="M366.284,900s65.57,134.915,54.937,243.017,85.064,216.205,159.495,248.1,241.015,51.393,288.864,10.633,28.354-95.7-15.95-111.647-93.925,28.355-81.52,74.431,205.572,140,372.156,0,189.622-232.154,311.9-230.381c0,0,53.165,10.633,53.165,51.393s-84.7,71.041-116.963,23.038,37.216-108.1,125.824-81.52,45.19,171.014-70,205.571c0,0,1.182-15.063-24.219-8.713s-24.368,15.211-23.481,16.688,18.238,24.958,18.238,24.958,16.836,1.4,26.287-6.793l2.437-23.334s-16.983,13.587-38.175,10.56-35.075,2.805-57.891,11.888-60.476,34.114-59.811,49.178,30.57,25.917,77.754,24.367,124.716-17.943,168.8-43.64,41.867-52.279,10.633-57.595-77.754-1.772-77.754-1.772,103.893-4.209,115.412,30.791-1.107,76.425-1.107,76.425-30.349-23.26-125.6-5.317-137.564,50.95-137.564,50.95-24.146-4.209-41.2,4.652-18.165,26.139-7.532,29.019,36.33,3.323,44.083,14.621,29.019,60.032,33.45,62.469,74.652,33.449,191.172-22.817c0,0,34.336-13.956,38.1-50.728s6.593-40.1,11.05-43.2,32.368-14.62,35.026-31.234-18.608-17.5-40.76-3.766c0,0-39.652-27.69-132.912-.222,0,0,97.248-23.26,126.045,7.532s-135.349,69.336-194.495,74.874-79.526-5.981-68.893-21.488,40.095-31.234,40.095-31.234-127.818-50.285-173.894-23.7-106.33,113.419-46.076,182.534,256.964,132.912,405.826,72.658,295.952-35.443,329.623,88.609-39.223,398.638-90.38,482.473c-158.665,260.01-122.114,380.358-71.09,449.631,37.965,51.544,49,118.238,28.1,178.746-4.91,14.212-8.715,28.085-10.171,39.877h-27.026l-22.152-14.915-34.114-5.317-19.494-14.62-25.032-5.317-16.392-11.3-20.38-3.766-16.393-10.855-23.7-2.879-12.183-10.633-13.291-.665-9.674,17.353,226.247,86.245,9.747-13.291-6.5,23.038-29.831,30.127s-26.583,89.79-64.389,158.9l3.84,44.6-7.384,17.131-34.262-9.156-25.992-15.064-37.216-10.338-34.262-19.493-36.624-8.566-27.174-15.359-21.856-3.839-15.359-9.747,3.249-7.384,231.563,85.064-230.086-89.79s15.063-21.561,27.764-31.9c0,0,33.228-108.1,62.912-163.04,0,0-2.778-28.172,2.65-45.119S960,2867.337,960,2950.629V4445.452s5.277,153.293,67.3,82.406,223.294-95.7,271.142-54.937c0,0,40.783,26.583,56.574,38.692s59.5,40.465,89.039,38.693c0,0,6.794,2.584,22.743-12.922l23.481,134.463s-13.069,28.576-76.867,45.412-87.28,5.538-87.28,5.538l-8.417-21.931s105.222,10.412,164.147-52.722l-10.19-61.583s-68.377,49.695-172.934,56.193l17.869,54.125-44.747-93.261s94.22,3.988,161.858-42.089c0,0-86.541,41.868-166.51,38.988,0,0-28.576-2.437,14.4-33.228,0,0-19.115-15.844-22.817-44.083-3.766-28.724,5.759-42.089,28.8-45.412s51.614,16.615,74.874,33.45,23.924,14.842,35,11.962,46.519-7.753,57.6-4.652,16.171,5.981,13.955,12.406c0,0-10.19,23.185-99.389,26.434,0,0-70.886,4.283-79.452,7.089s-127.744,27.173-118.44,104.263c0,0,22.595,73.1-14.62,98.355S856.731,5167.168,818.187,5406.41s44.3,415.131,44.3,415.131"
          transform="translate(-365.834 -899.781)"
          fill="none"
          stroke="#231f20"
          stroke-miterlimit="10"
          stroke-width="1"
        />
      </svg>
    </div>

    <script>
      const svgContent = document.querySelector(".svg_content");
      const path = document.querySelector(".path_332");
      const pathLength = path.getTotalLength();

      path.style.strokeDasharray = pathLength;
      path.style.strokeDashoffset = calcDashoffset(
        window.innerHeight * 1.8,
        svgContent,
        pathLength
      );
      // path.style.strokeDashoffset = pathLength;

      function calcDashoffset(scrollY, element, length) {
        const ratio = (scrollY - element.offsetTop) / element.offsetHeight;
        const value = length - length * ratio;
        return value < 0 ? 0 : value > length ? length : value;
      }

      function scrollHandler() {
        if (window.scrollY > 3500) {
          const scrollY = window.scrollY + window.innerHeight * 0.8;
        }

        const scrollY = window.scrollY + window.innerHeight * 1.8;
        path.style.strokeDashoffset = calcDashoffset(
          scrollY,
          svgContent,
          pathLength
        );

        console.log(window.scrollY);
      }

      window.addEventListener("scroll", scrollHandler);
    </script>
  </body>
</html>
